#!/usr/bin/env node
import g from"fs";import*as n from"node:fs";import*as s from"node:path";import*as i from"node:child_process";import o from"node:process";async function c(){let r=o.argv[1];if(!r)return{packageManager:"unknown",isGlobal:!1};let t=o.cwd();try{let a=n.realpathSync(r).replace(/\\/g,"/"),l=t.replace(/\\/g,"/");if(l&&a.startsWith(l)&&!a.includes("/node_modules/"))return{packageManager:"unknown",isGlobal:!1,updateMessage:'Running from a local git clone. Please update with "git pull".'};if(a.includes("/.npm/_npx")||a.includes("/npm/_npx"))return{packageManager:"npx",isGlobal:!1,updateMessage:"Running via npx, update not applicable."};if(o.platform==="darwin")try{return i.execSync('brew list -1 | grep -q "^cli$"',{stdio:"ignore"}),{packageManager:"homebrew",isGlobal:!0,updateMessage:'Installed via Homebrew. Please update with "brew upgrade".'}}catch{}if(a.includes("/pnpm/dlx")||a.includes("/pnpm-cache/dlx"))return{packageManager:"pnpx",isGlobal:!1,updateMessage:"Running via pnpx, update not applicable."};if(a.includes("/pnpm/global"))return{packageManager:"pnpm",isGlobal:!0,updateCommand:"pnpm add -g @snelusha/cli@latest",updateMessage:"Please run pnpm add -g @snelusha/cli@latest to update"};if(a.includes("/.yarn/global"))return{packageManager:"yarn",isGlobal:!0,updateCommand:"yarn global add @snelusha/cli@latest",updateMessage:"Please run yarn global add @snelusha/cli@latest to update"};if(a.includes("/bunx"))return{packageManager:"bunx",isGlobal:!1,updateMessage:"Running via bunx, update not applicable."};if(a.includes("/.bun/install/global"))return{packageManager:"bun",isGlobal:!0,updateCommand:"bun add -g @snelusha/cli@latest",updateMessage:"Please run bun add -g @snelusha/cli@latest to update"};if(l&&a.startsWith(`${l}/node_modules`)){let e="npm";if(n.existsSync(s.join(t,"yarn.lock")))e="yarn";else if(n.existsSync(s.join(t,"pnpm-lock.yaml")))e="pnpm";else if(n.existsSync(s.join(t,"bun.lockb"))||n.existsSync(s.join(t,"bun.lock")))e="bun";return{packageManager:e,isGlobal:!1,updateMessage:"Locally installed. Please update via your project's package.json."}}let p="npm install -g @snelusha/cli@latest";return{packageManager:"npm",isGlobal:!0,updateCommand:p,updateMessage:`Please run ${p} to update`}}catch{return{packageManager:"unknown",isGlobal:!1}}}var u=process.argv[1],d=g.realpathSync(u).replace(/\\/g,"/");console.log(u);console.log(d);var m=await c();console.log(m);

// Made by a human on earth!
